import{u as O,r as h,g as x,h as z,c as i,a as F,b as I,d as t,t as k,i as m,j as y,v as B,n as C,F as b,k as U,o as r,l as L}from"./index-ChMq0LXP.js";import{a as c,S as l,L as j}from"./sweetalert2-HwGyHZb6.js";const A={id:"todoListPage",class:"bg-half"},R={class:"todo_sm"},W={class:"conatiner todoListPage vhContainer"},q={class:"todoList_Content"},G={class:"inputBox"},H={class:"todoList_list"},J={class:"todoList_tab"},K={class:"todoList_items"},Q={class:"todoList_item"},X={class:"todoList_label"},Y=["checked","onClick"],Z=["onClick"],ee={key:2},te={class:"edit"},se=["onClick"],oe=["onClick"],ae={class:"todoList_statistics"},le={key:0},ne={key:1},d="https://todolist-api.hexschool.io",ce={__name:"TodoView",setup(ie){const g=O(),$=h(""),T=()=>{var e;o.value=!0;const s=(e=document.cookie.split("; ").find(a=>a.startsWith("myToken")))==null?void 0:e.split("=")[1];s||g.push("/"),c.defaults.headers.common.Authorization=s,c.get(`${d}/users/checkout`).then(a=>{$.value=a.data.nickname,_(),o.value=!1}).catch(a=>{o.value=!1,l.fire({icon:"error",title:"請重試一次",text:a.response.data.message}),g.push("/")})},v=h([]),_=()=>{o.value=!0,c.get(`${d}/todos/`).then(s=>{v.value=s.data.data,o.value=!1}).catch(s=>{o.value=!1,l.fire({icon:"error",title:"請重試一次",text:s.response.data.message})})},f=h(""),w=()=>{if(!f.value.trim()){l.fire({icon:"error",text:"請輸入內容"}),f.value="";return}o.value=!0,c.post(`${d}/todos/`,{content:f.value}).then(()=>{f.value="",o.value=!1,_(),l.fire({position:"top",title:"新增成功",icon:"success",timer:2e3,toast:!0,showConfirmButton:!1,timerProgressBar:!0})}).catch(s=>{l.fire({icon:"error",title:"請重試一次",text:s.response.data.message}),o.value=!1})},P=s=>{o.value=!0,c.delete(`${d}/todos/${s.id}`).then(e=>{_(),o.value=!1,l.fire({position:"top",title:e.data.message,icon:"success",timer:2e3,toast:!0,showConfirmButton:!1,timerProgressBar:!0})}).catch(e=>{o.value=!1,l.fire({icon:"error",title:"請重試一次",text:e.response.data.message})})},n=h({}),V=s=>{n.value={...s}},N=s=>{o.value=!0,c.put(`${d}/todos/${s.id}`,{content:n.value.content}).then(e=>{_(),o.value=!1,l.fire({position:"top",title:e.data.message,icon:"success",timer:2e3,toast:!0,showConfirmButton:!1,timerProgressBar:!0}),n.value={}}).catch(e=>{o.value=!1,l.fire({icon:"error",title:"請重試一次",text:e.response.data.message})})},D=s=>{o.value=!0,c.patch(`${d}/todos/${s.id}/toggle`).then(e=>{_(),o.value=!1,l.fire({position:"top",title:e.data.message,icon:"success",timer:2e3,toast:!0,showConfirmButton:!1,timerProgressBar:!0})}).catch(e=>{l.fire({icon:"error",title:"請重試一次",text:e.response.data.message}),o.value=!1})},u=h("all"),S=x(()=>u.value==="all"?v.value:u.value==="unCompleted"?v.value.filter(s=>!s.status):v.value.filter(s=>s.status)),E=x(()=>v.value.filter(s=>!s.status).length),o=h(!1),M=()=>{o.value=!0,c.post(`${d}/users/sign_out`).then(s=>{o.value=!1,l.fire({position:"top",title:s.data.message,icon:"success",timer:2e3,toast:!0,showConfirmButton:!1,timerProgressBar:!0}),document.cookie="myToken=;",g.push("/")}).catch(s=>{o.value=!1,l.fire({icon:"error",title:"請重試一次",text:s.response.data.message})})};return z(()=>{T()}),(s,e)=>(r(),i(b,null,[F(I(j),{active:o.value},null,8,["active"]),t("div",A,[t("nav",null,[e[6]||(e[6]=t("h1",null,[t("a",{href:"#"},"ONLINE TODO LIST")],-1)),t("ul",null,[t("li",R,[t("span",null,k($.value),1)]),t("li",null,[t("a",{href:"#",onClick:m(M,["prevent"])},"登出")])])]),t("div",W,[t("div",q,[t("div",G,[y(t("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":e[0]||(e[0]=a=>f.value=a)},null,512),[[B,f.value]]),t("a",{href:"#",onClick:m(w,["prevent"])},e[7]||(e[7]=[t("i",{class:"fa fa-plus"},null,-1)]))]),t("div",H,[t("ul",J,[t("li",null,[t("a",{href:"#",class:C({active:u.value==="all"}),onClick:e[1]||(e[1]=m(a=>u.value="all",["prevent"]))},"全部",2)]),t("li",null,[t("a",{href:"#",class:C({active:u.value==="unCompleted"}),onClick:e[2]||(e[2]=m(a=>u.value="unCompleted",["prevent"]))},"待完成",2)]),t("li",null,[t("a",{href:"#",class:C({active:u.value==="completed"}),onClick:e[3]||(e[3]=m(a=>u.value="completed",["prevent"]))},"已完成",2)])]),t("div",K,[t("ul",Q,[(r(!0),i(b,null,U(S.value,a=>(r(),i("li",{key:a.id},[t("label",X,[t("div",null,[t("input",{class:"todoList_input",type:"checkbox",checked:a.status,onClick:p=>D(a)},null,8,Y),n.value.id===a.id?y((r(),i("input",{key:0,type:"text","onUpdate:modelValue":e[4]||(e[4]=p=>n.value.content=p)},null,512)),[[B,n.value.content]]):L("",!0),n.value.id===a.id?(r(),i("button",{key:1,type:"button",onClick:p=>N(a)}," 確定 ",8,Z)):(r(),i("span",ee,k(a.content),1))])]),t("div",te,[n.value.id?L("",!0):(r(),i("button",{key:0,type:"button",onClick:p=>V(a)},"編輯",8,se)),n.value.id===a.id?(r(),i("button",{key:1,type:"button",onClick:e[5]||(e[5]=p=>n.value={})}," 取消 ")):L("",!0),t("a",{href:"#",onClick:m(p=>P(a),["prevent"])},e[8]||(e[8]=[t("i",{class:"fa fa-times"},null,-1)]),8,oe)])]))),128))]),t("div",ae,[v.value.length?(r(),i("p",ne,k(E.value)+" 個待完成項目",1)):(r(),i("p",le,"目前尚無待辦事項"))])])])])])])],64))}};export{ce as default};
